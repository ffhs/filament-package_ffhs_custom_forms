function u(t){return t._x_dataStack===void 0?{}:Alpine.mergeProxies(t._x_dataStack)}function m(t){return u(t).group??null}function p(t){let e=u(t);return e===null?null:e.element??null}function E(t){return u(t).element!==null}function B(t){return u(t).parent??!1}function A(t){return u(t).container??!1}function N(t){return u(t).drag??!1}function K(t){return x(t)!==null}function x(t){return u(t).action??null}function P(){return document.querySelector("[ffhs_drag\\:dragging]")}function f(t){let e=t;for(;e&&!(e instanceof Document);){if(e.hasAttribute("ffhs_drag:component")&&B(e))return e;e=e.parentNode}return null}function D(t,e){let r=m(t);if(r===void 0)return!1;let n=m(e);return n===void 0?!1:r===n}function w(t,e=r=>N(r)||A(r)){let r=t;for(;r&&!(r instanceof Document);){if(e(r))return r;r=r.parentNode}return null}function h(t,e,r){if(!e[`__has_${t}`]){let n=o=>r(o);e.addEventListener(t,n),e[`__has_${t}`]=!0}}function J(t,e){let r=P();r!=null&&D(r,t)&&(f(t)?.getAttribute("disabled")||(e.stopPropagation(),e.preventDefault(),!(!A(t)&&p(t)===p(r))&&setTimeout(()=>{t.setAttribute("ffhs_drag:hower_over",!0)},0)))}function j(t){P()!=null&&(t.preventDefault(),t.stopPropagation(),_())}function O(t){h("dragenter",t,e=>J(t,e)),h("dragleave",t,e=>j(e)),h("dragover",t,e=>e.preventDefault())}function _(){document.querySelectorAll("*").forEach(t=>{t.removeAttribute("ffhs_drag:hower_over")})}function v(t,e){E(t)?t.before(e):A(t)&&t.insertBefore(e,t.firstChild)}function G(t,e){if(p(t)===null)return!1;let n=f(t);return u(n).statePath===e.statePath}function z(t,e){let r=0;return t.querySelectorAll("[ffhs_drag\\:component]").forEach(n=>{G(n,e)&&r++}),r}function H(t,e,r,n){let o=1,s=n.dragDropPosAttribute,d=n.dragDropEndPosAttribute,l=crypto.randomUUID().split("-"),c=l[0]+l[1];e.querySelectorAll("[ffhs_drag\\:component]").forEach(i=>{if(!G(i,n))return;let a=p(i),g=z(i,n);t[a]===void 0&&(t[a]={}),t[a][s]=o,t[a][d]=g===0?null:o+g,o++})}function M(t,e,r,n){let o=1,s=n.orderAttribute,d=f(e);e.querySelectorAll("[ffhs_drag\\:component]").forEach(l=>{let c=p(l);if(!c||m(l)!==r)return;let i=f(l);d===i&&(t[c]===void 0&&(t[c]={}),t[c][s]=o,o++)})}function y(t,e,r,n){n.flatten?H(t,e,r,n):n.orderAttribute!==null&&M(t,e,r,n)}function I(t,e){let r=f(t),n=u(r),o=n.wire.get(n.statePath,"");(!o||Array.isArray(o))&&(o={});let s=m(r),d=f(e),l=d===r;if(r.getAttribute("disabled"))return;if(v(t,e),!l){let i=u(d),a=i.wire.get(i.statePath,"");(!a||Array.isArray(a))&&(a={});let g=p(e);o[g]=a[g],delete a[g],y(a,d,s,i),i.wire.set(i.statePath,a,!1)}if(y(o,r,s,n),r.getAttribute("disabled"))return;let c=!l||n.isLive;n.wire.set(n.statePath,o,c)}function Q(t,e,r){let n=document.createElement("span");return n.setAttribute("x-data",`dragDropElement('${t}','${e}')`),n.setAttribute("ffhs_drag:component",null),n.classList.add("hidden"),v(r,n),Alpine.initTree(n),n}function R(){let t=crypto.randomUUID().split("-");return t[0]+t[1]}function V(t,e,r,n){return t?e[r][n.dragDropPosAttribute]:e[r][n.orderAttribute]}function T(t,e){let r=f(t),n=m(r),o=u(r),s=o.flatten,d=o.wire,l=d.get(o.statePath,"");if(Array.isArray(l)&&(l={}),r.getAttribute("disabled"))return;let c=p(t),i=R(),a=Q(n,i,t),g=JSON.parse(JSON.stringify(l));y(g,r,n,o);let k=V(s,g,i,o),b=null,S=null;s&&(b=w(a.parentNode,L=>E(L))),b&&(S=p(b));let C=x(e),F=C.split("'")[1],U=C.split("'")[3];if(r.getAttribute("disabled"))return;let q={targetPath:o.statePath,position:k,flatten:s,targetIn:S,target:c};d.mountFormComponentAction(F,U,q)}function $(t){h("drop",t,e=>{e.stopPropagation(),e.preventDefault();let r=P();r!=null&&r!==t&&D(r,t)&&(f(t).getAttribute("disabled")||(_(),K(r)?T(t,r):I(t,r)))})}function W(t){return{group:t,container:!0,action:null,element:null,parent:!1,drag:!1,init(){O(this.$el),$(this.$el)}}}export{W as default};
