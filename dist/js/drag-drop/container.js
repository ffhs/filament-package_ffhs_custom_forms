function u(t){return t._x_dataStack===void 0?{}:Alpine.mergeProxies(t._x_dataStack)}function g(t){return u(t).group??null}function p(t){let e=u(t);return e===null?null:e.element??null}function E(t){let e=u(t);return e.element!==null&&e.element!==void 0}function N(t){return u(t).parent??!1}function A(t){return u(t).container??!1}function B(t){return u(t).drag??!1}function w(t){return x(t)!==null}function x(t){return u(t).action??null}function P(){return document.querySelector("[ffhs_drag\\:dragging]")}function f(t){let e=t;for(;e&&!(e instanceof Document);){if(e.hasAttribute("ffhs_drag:component")&&N(e))return e;e=e.parentNode}return null}function D(t,e){let r=g(t);if(r===void 0)return!1;let n=g(e);return n===void 0?!1:r===n}function K(t,e=r=>B(r)||A(r)){let r=t;for(;r&&!(r instanceof Window);){if(e(r))return r;r=r.parentNode}return null}function m(t,e,r){if(!e[`__has_${t}`]){let n=i=>r(i);e.addEventListener(t,n),e[`__has_${t}`]=!0}}function J(t,e){let r=P();r!=null&&D(r,t)&&(f(t)?.getAttribute("disabled")||(e.stopPropagation(),e.preventDefault(),!(!A(t)&&p(t)===p(r))&&setTimeout(()=>{t.setAttribute("ffhs_drag:hower_over",!0)},0)))}function W(t){P()!=null&&(t.preventDefault(),t.stopPropagation(),v())}function O(t){m("dragenter",t,e=>J(t,e)),m("dragleave",t,e=>W(e)),m("dragover",t,e=>e.preventDefault())}function v(){document.querySelectorAll("*").forEach(t=>{t.removeAttribute("ffhs_drag:hower_over")})}function _(t,e){E(t)?t.before(e):A(t)&&t.prepend(e)}function G(t,e){if(p(t)===null)return!1;let n=f(t);return u(n).statePath===e.statePath}function j(t,e){let r=0;return t.querySelectorAll("[ffhs_drag\\:component]").forEach(n=>{G(n,e)&&r++}),r}function z(t,e,r,n){let i=1,d=n.dragDropPosAttribute,s=n.dragDropEndPosAttribute;e.querySelectorAll("[ffhs_drag\\:component]").forEach(o=>{if(!G(o,n))return;let a=p(o),l=j(o,n);t[a]===void 0&&(t[a]={}),t[a][d]=i,t[a][s]=l===0?null:i+l,i++})}function H(t,e,r,n){let i=1,d=n.orderAttribute,s=f(e);e.querySelectorAll("[ffhs_drag\\:component]").forEach(o=>{let a=p(o);if(!a||g(o)!==r)return;let l=f(o);s===l&&(t[a]===void 0&&(t[a]={}),t[a][d]=i,i++)})}function b(t,e,r,n){n.flatten?z(t,e,r,n):n.orderAttribute!==null&&H(t,e,r,n)}function T(t,e){let r=f(t),n=u(r),i=n.wire.get(n.statePath,"");(!i||Array.isArray(i))&&(i={});let d=g(r),s=f(e),o=s===r;if(r.getAttribute("disabled"))return;if(_(t,e),!o){let l=u(s),c=l.wire.get(l.statePath,"");(!c||Array.isArray(c))&&(c={});let h=p(e);i[h]=c[h],delete c[h],b(c,s,d,l),l.wire.set(l.statePath,c,!1)}if(b(i,r,d,n),r.getAttribute("disabled"))return;let a=!o||n.isLive;n.wire.set(n.statePath,i,a)}function M(t,e,r){let n=document.createElement("div");return n.setAttribute("x-data",`typeof dragDropElement === 'undefined'? {}: dragDropElement('${t}','${e}')`),n.setAttribute("ffhs_drag:component",null),n.classList.add("hidden"),_(r,n),Alpine.initTree(n),n}function Q(){let t=crypto.randomUUID().split("-");return t[0]+t[1]}function R(t,e,r,n){return t?e[r]===void 0?1:e[r][n.dragDropPosAttribute]??1:e[r]===void 0?1:e[r][n.orderAttribute]??1}function $(t,e){let r=f(t),n=g(r),i=u(r),d=i.flatten,s=i.wire,o=s.get(i.statePath,"");if(Array.isArray(o)&&(o={}),r.getAttribute("disabled"))return;let a=p(t),l=Q(),c=M(n,l,t),h=JSON.parse(JSON.stringify(o));b(h,r,n,i);let I=R(d,h,l,i),y=null,S=null;d&&(y=K(c.parentNode,k=>E(k))),y&&(S=p(y));let C=x(e),q=C.split("'")[1],L=C.split("'")[3];if(r.getAttribute("disabled"))return;let U={targetPath:i.statePath,position:I,flatten:d,targetIn:S,target:a};s.mountFormComponentAction(q,L,U)}function F(t){m("drop",t,e=>{e.stopPropagation(),e.preventDefault();let r=P();r!=null&&r!==t&&D(r,t)&&(f(t).getAttribute("disabled")||(v(),w(r)?$(t,r):T(t,r)))})}function V(t){return{group:t,container:!0,action:null,element:null,parent:!1,drag:!1,init(){O(this.$el),F(this.$el)}}}export{V as default};
